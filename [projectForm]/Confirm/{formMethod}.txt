  //%attributes = {"lang":"en"} comment added and reserved by 4D.
If (Form event=On Load)
	FORM GOTO PAGE(vlPageRouter)
	Case of 
		: (vlPageRouter=8)
			FORM GOTO PAGE(8)
		: (<>tAlert="How many days?")
			FORM GOTO PAGE(6)
		: (<>tAlert="How do you want capture the image?")
			FORM GOTO PAGE(5)
			OBJECT SET TITLE(bAccept;vsChoice1)
			OBJECT SET TITLE(bChoice2;vsChoice2)
			OBJECT SET TITLE(bChoice3;vsChoice3)
			OBJECT SET TITLE(bCancel;vsChoice4)
			If (Picture size(vxSketch)>5)
				OBJECT SET ENABLED(bChoice2;True)
			Else 
				OBJECT SET ENABLED(bChoice2;False)
			End if 
			If (<>vtPicturePath#"") | (<>vtCopyPath#"")
				OBJECT SET ENABLED(bChoice3;True)
			Else 
				OBJECT SET ENABLED(bChoice3;False)
			End if 
		: (<>tAlert="Do you want to import from file, or paste?")
			FORM GOTO PAGE(5)
			OBJECT SET TITLE(bAccept;vsChoice1)
			OBJECT SET TITLE(bChoice2;vsChoice2)
			OBJECT SET TITLE(bChoice3;vsChoice3)
			OBJECT SET TITLE(bCancel;vsChoice4)
			If (Picture size(<>xSketch)>0)
				OBJECT SET ENABLED(bChoice3;True)
			Else 
				OBJECT SET ENABLED(bChoice3;False)
			End if 
		: (vlPageRouter=1)
			OBJECT SET TITLE(bAccept;vsChoice1)
			OBJECT SET TITLE(bCancel;vsChoice2)
		: (vlPageRouter=2)
			OBJECT SET TITLE(bAccept;vsChoice1)
			OBJECT SET TITLE(bChoice2;vsChoice2)
			OBJECT SET TITLE(bCancel;vsChoice3)
		: (vlPageRouter=3)
			OBJECT SET TITLE(bAccept;vsChoice1)
			OBJECT SET TITLE(bChoice2;vsChoice2)
			OBJECT SET TITLE(bChoice3;vsChoice3)
			OBJECT SET TITLE(bCancel;vsChoice4)
		: (vlPageRouter=4)
			OBJECT SET TITLE(bAccept;vsChoice1)
			OBJECT SET TITLE(bChoice2;vsChoice2)
			OBJECT SET TITLE(bChoice3;vsChoice3)
			OBJECT SET TITLE(bChoice4;vsChoice4)
			OBJECT SET TITLE(bCancel;vsChoice5)
		: (vlPageRouter=7)
			OBJECT SET TITLE(bAccept;vsChoice1)
			OBJECT SET TITLE(bChoice2;vsChoice2)
			OBJECT SET TITLE(bChoice3;vsChoice3)
			OBJECT SET TITLE(bChoice4;vsChoice4)
			OBJECT SET TITLE(bChoice5;vsChoice5)
	End case 
End if 